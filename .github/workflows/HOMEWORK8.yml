
name: Deploy in kubernetes

on:
  push:
    branches: [ Hometask_8 ]
    
jobs:
  deploy:
    runs-on: ubuntu-18.04
    steps:

    # - name: Checkout source code
    #   run: cd .. && ls -la && pwd
    # env:
    #   workdir-directory: ./SergeyLadutko/Hometask_8/
    # steps:
    # - uses: actions/checkout@master
    # - name: Run Snyk to check for vulnerabilities
    #   uses: snyk/actions/node@master
    #   env:
    #     SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}
    #   with:
    #     command: test ./SergeyLadutko/Hometask_8/

    # - name: Publish to Registry
    #   uses: opspresso/action-docker@maste
    #   # run: ls -la && pwd
    #   with:
    #     IMAGE_NAME: "USERNAME/IMAGE_NAME"
    #     # repository: sergeyladutko/kuber
    #     username: ${{ secrets.DOCKER_USERNAME }}
    #     password: ${{ secrets.DOCKER_PASSWORD }}
    #     tags: latest
    #     DOCKERFILE: SergeyLadutko/Hometask_8/Dockerfile
    #     # path: SergeyLadutko/Hometask_8/
    #     # dockerfile: Dockerfile


    - name: Publish to Registry
      uses: opspresso/action-docker@maste
      # run: ls -la && pwd
      with:
        IMAGE_NAME: "USERNAME/IMAGE_NAME"
        # repository: sergeyladutko/kuber
        USERNAME: ${{ secrets.DOCKER_USERNAME }}
        PASSWORD: ${{ secrets.DOCKER_PASSWORD }}
        IMAGE_NAME: "USERNAME/IMAGE_NAME"
        TAG_NAME: "v0.0.1"
        LATEST: "true"
        DOCKERFILE: "SergeyLadutko/Hometask_8/Dockerfile"
        # path: SergeyLadutko/Hometask_8/
        # dockerfile: Dockerfile

